module VariableDelay:
  generics:
    uint(8)       delay = 8
  ports:
    bit           in      clk
    bit           in      rst
    bit           in      din
    sint(8)       in      sel
    bit           out     dout

arch behavior:
  signals:
    # Shift register
    bit[delay:1]  reg = x'00'

  logic:
 
    spro(clk,rst):
      reg  = reg[delay-1:1] & din
      dout = reg[sel]
